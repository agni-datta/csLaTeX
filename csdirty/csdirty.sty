%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% csdirty.sty - A LaTeX Package by Agni Datta
% This package consolidates commonly used LaTeX packages
% for easy document preparation. It combines essential packages
% into one, making it easier for users to set up their documents.
% By reducing the need to load multiple packages separately, it
% ensures compatibility and saves time. The package aims to simplify
% document formatting and structure, improving productivity.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\ProvidesPackage{csdirty}[2025/02/10 v1.0 csdirty package]

\makeatletter

% Required packages
\RequirePackage{xparse} % For new command/environment definitions
\RequirePackage{comment} % For comment environment

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Package Options: Versioning, Comments, and Anonymization
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Toggle switches for versioning, comments, and anonymization
\newif\ifFullVersion    % Full version enabled
\newif\ifShortVersion   % Short version enabled
\newif\ifComments       % Comments enabled
\newif\ifAnonymize      % Anonymization enabled

% Default settings:
\FullVersionfalse       % Full version off by default
\ShortVersiontrue       % Short version on by default
\Commentsfalse          % Comments off by default
\Anonymizefalse         % Anonymization off by default

% Define package options
\DeclareOption{comments}{\Commentstrue}        % Enable comments
\DeclareOption{nocomments}{\Commentsfalse}     % Disable comments
\DeclareOption{fullversion}{\FullVersiontrue\ShortVersionfalse}  % Full version only
\DeclareOption{shortversion}{\ShortVersiontrue\FullVersionfalse} % Short version only
\DeclareOption{preprint}{\ShortVersiontrue\FullVersionfalse} % Preprint format
\DeclareOption{anonymize}{\Anonymizetrue}      % Enable anonymization

\DeclareOption*{\relax}  % Ignore unknown options
\ProcessOptions\relax    % Apply the selected options

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Page Layout and Spacing Settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[english]{babel}                          % English language support
\RequirePackage[2.0, objcompress, compress]{bxpdfver}    % PDF version and compression settings
\RequirePackage[a4paper, margin=2.75cm]{geometry}        % Page dimensions
\RequirePackage[onehalfspacing]{setspace}                % 1.5 line spacing
\renewcommand{\baselinestretch}{1.15}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Mathematical Tools and Fonts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[T1]{fontenc}                              % Type 1 font encoding
\RequirePackage{amsfonts}                                 % AMS fonts (e.g., blackboard bold)
\RequirePackage{amsmath}                                  % Advanced math environments
\RequirePackage{amssymb}                                  % Additional symbols
\RequirePackage{amsthm}                                   % Theorem-like environments
\RequirePackage{bm}                                       % Bold math symbols (\bm{})
\RequirePackage{mathrsfs}                                 % Script-style math fonts (\mathscr{})
\RequirePackage{mathtools}                                % Enhancements for amsmath
\RequirePackage{nicefrac}                                 % Nicer fraction formatting (\nicefrac)
\RequirePackage{siunitx}                                  % Consistent units and numbers
\RequirePackage{lmodern}                                  % Latin Modern font
\RequirePackage[cal=cm, bb=bboldx]{mathalpha}             % Custom calligraphic and bbold fonts

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Colour Management
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[x11names, dvipsnames, svgnames]{xcolor}    % Provides named colours
\RequirePackage{xspace}                                    % Intelligent spacing after commands

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Text and Font Enhancements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[autostyle=true, csdisplay=true]{csquotes} % Smart quotation marks
\RequirePackage[final]{microtype}                         % Enhanced justification and hyphenation
\RequirePackage{textcomp}                                 % Text symbols (e.g., degree sign)
\RequirePackage[normalem]{ulem}                           % Underlining and strikethroughs
\RequirePackage{lmodern}                                  % Latin Modern font family

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Algorithm Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[algonl, boxed, longend, vlined]{algorithm2e}
\SetAlFnt{\small}                                        % Algorithm text size: small
\SetAlCapNameFnt{\normalfont\rmfamily}                   % Algorithm caption title font
\SetAlCapFnt{\normalfont\rmfamily\color{\accentcolor}}   % Algorithm caption text font
\SetAlgoSkip{medskip}                                    % Spacing between algorithm steps
\SetAlgoInsideSkip{medskip}                              % Spacing within the algorithm
\SetAlCapSkip{1em}                                       % Spacing between caption and content
\SetAlgoNlRelativeSize{-2}                               % Reduce line number size
\SetNlSty{texttt}{[}{]}                                  % Line number style
\SetAlgoCaptionSeparator{.}                              % Caption-content separator
\RequirePackage{listings}                                % Code syntax highlighting
\RequirePackage{fancyvrb}                                % Enhanced verbatim environments

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hyperlinks and Cross-referencing
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[
	frenchlinks=true,             % Small caps for hyperlinks
	unicode=true,                 % Unicode support in hyperlinks
	bookmarksnumbered=true,       % Numbered bookmarks
	breaklinks=true,              % Line-breaking in links
	colorlinks=true,              % Coloured hyperlinks
	linkcolor=RoyalBlue4,         % Link colour
	citecolor=DodgerBlue2,        % Citation link colour
	urlcolor=RoyalBlue3,          % URL link colour
	pdfusetitle,                  % PDF bibliographic details
	pagebackref                   % Back-references to objects
]{hyperref}%
\renewcommand*{\backref}[1]{}%
\renewcommand*{\backrefalt}[4]{%
	\ifcase #1%
	\or (Cited on page~#2).%
	\else (Cited on pages~#2).%
	\fi%
}%
\RequirePackage{xr}                                     % Cross-referencing between documents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Figures and Tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{adjustbox}                              % Flexible content adjustments
\RequirePackage{array}                                  % Enhanced arrays and tables
\RequirePackage{booktabs}                               % Professional table rules
\RequirePackage{float}                                  % Better float placement
\RequirePackage{graphicx}                               % Graphics inclusion
\RequirePackage{longtable}                              % Multi-page tables
\RequirePackage{multirow}                               % Multi-row table cells
\RequirePackage{ragged2e}                               % Improved text alignment
\RequirePackage{subcaption}                             % Subfigure and subcaption features

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Customisable Lists
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{enumitem}                               % Enhanced list customisation
\setlist{nosep}                                         % Remove extra list spacing
\setlist[enumerate,1]{label=(\arabic*)}                 % First-level enumerations
\setlist[enumerate,2]{label=(\alph*)}                   % Second-level enumerations
\setlist[itemize,1]{label=\ensuremath{\color{black!75}\bullet}} % Primary bullet style
\setlist[itemize,2]{label=\ensuremath{\color{black!75}\circ}}    % Secondary bullet style

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Diagrams and Graphics
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[skipabove=10pt, skipbelow=10pt, ntheorem, framemethod=Tikz]{mdframed}%
\RequirePackage{pgfplots}%
\pgfplotsset{compat=1.18}%
\RequirePackage{tikz}%
\RequirePackage{tikz-cd}%
\RequirePackage{tikz-3dplot}%
\usetikzlibrary{
	arrows, automata, backgrounds, calc, decorations.markings,
	decorations.pathmorphing, decorations.text, fit, graphs, intersections,
	matrix, patterns, positioning, scopes, shapes.geometric
}%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Miscellaneous Enhancements
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{etoolbox}                               % Conditional logic
\RequirePackage{lipsum}                                 % Placeholder text
\RequirePackage{pdfpages}                               % Include external PDFs
\RequirePackage{xurl}                                   % URL line-breaking support

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Appendix Handling
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[
	toc,        % Appendices in the table of contents
	page,       % New page for each appendix
	title,      % Prefix appendix titles with "Appendix"
	header,     % Add "Appendix" to headers
	titletoc    % Prefix appendix entries in TOC
]{appendix}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Document Environments for Abstract and Acknowledgment
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Redefine abstract environment with small and indented format
\@ifclassloaded{book}{
	\NewDocumentEnvironment{abstract}{}{%
		\quotation\small\textbf{\abstractname.~}%
		}{%
		\endquotation%
		}}{
\RenewDocumentEnvironment{abstract}{}{%
	\quotation\small\textbf{\abstractname.~}%
	}{%
	   \endquotation%
    }
}

% Define acknowledgment environment with optional title argument
\NewDocumentEnvironment{acknowledgment}{ o }{%
    \IfNoValueTF{#1}{%
        \paragraph*{Acknowledgment}  % Default title
    }{%
        \paragraph*{#1}  % Custom title if provided
    }
}

% Suppress acknowledgment in anonymized mode
\ifAnonymize
    \RenewDocumentEnvironment{acknowledgment}{ o }{}{ }  % Empty environment
\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Compatibility Adjustments and Custom Commands (At End of Package)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\AtEndOfPackage{%
	%%% Compatibility Adjustments for Specific Document Classes %%%
	\NewDocumentCommand{\loadcsthm}{}{%
		\IfFileExists{csthm.sty}{%
			\RequirePackage[oldschool]{csthm}% Load csthm for theorems
			\providecommand{\accentcolor}{black!75}% Default accent color
			\setaccentcolor{black!75}%
			}{%
			\PackageWarning{csdirty}{The package `csthm` is missing. Please install it.}%
			\providecommand{\accentcolor}{black!75}% Fallback accent color
		}%
	}%
	%%% Cryptography and Complexity Theory %%%
	\IfFileExists{tcscrypto.sty}{%
		\RequirePackage{tcscrypto}%
		}{%
		\PackageWarning{csdirty}{The package `tcscrypto` is missing. Please install it.}%
	}%
	% Simplify references (e.g., "Theorem 1")
	\RequirePackage[capitalise]{cleveref}%
	\renewcommand{\cref}[1]{\Cref{#1}}%
	% Adjustments for 'llncs' class
	\@ifclassloaded{llncs}{%
		\RequirePackage{etoolbox}%
		\setlength{\belowcaptionskip}{-10pt}%
		}{}%
	% Adjustments for 'amsart' class
	\@ifclassloaded{amsart}{%
		\loadcsthm%
		\RequirePackage[foot]{amsaddr}%
		}{}%
	% Common font and title settings
	\NewDocumentCommand{\sethepfonts}{}{%
		\RequirePackage{hep-title}%
		\titlefont{\normalfont\LARGE\scshape}%
		\authorfont{\normalfont\large\scshape}%
		\affiliationfont{\normalfont\normalsize\scshape}%
		\datefont{\normalfont\small\scshape}%
		\RequirePackage{titlesec}%
		\RequirePackage[titles]{tocloft}%
	}%
	\NewDocumentCommand{\adjusttocspacing}{mmm}{%
		\addtolength{\cftchapnumwidth}{#1}%
		\addtolength{\cftsecnumwidth}{#2}%
		\addtolength{\cftsubsecnumwidth}{#3}%
	}%
	\NewDocumentCommand{\setchapterformat}{}{%
		\titleformat{\chapter}[display]{\huge}%
		{\filleft\textrm{\textsc{\large\chaptertitlename}~\textsf{\Huge\thechapter}}}%
		{4ex}{\commonheadingfont\titlerule\vspace{2ex}\filright}%
		[\vspace{2ex}\titlerule]%
	}%
	\NewDocumentCommand{\setsectionformats}{}{%
		\titleformat{\section}{\commonheadingfont\Large}{\thesection}{10pt}{}%
		\titleformat{\subsection}{\commonheadingfont\large}{\thesubsection}{10pt}{}%
		\titleformat{\subsubsection}{\commonheadingfont\large}{\thesubsubsection}{10pt}{}%
		\titleformat{\paragraph}[runin]{\normalsize\bfseries}{\theparagraph}{10pt}{}%
		\titleformat{\subparagraph}[runin]{\normalsize\scshape}{\thesubparagraph}{10pt}{}%
	}%
	\NewDocumentCommand{\simplefancyheader}{}{%
		\RequirePackage{fancyhdr}%
		\pagestyle{fancy}%
		\fancyhf{}%
		\fancyhead[LE,RO]{\sffamily\@title}%
		\fancyhead[RE,LO]{\sffamily\thepage}%
		\fancyfoot{}%
		\setlength{\headheight}{12pt}%
	}%
	% Adjustments for the 'article' class
	\@ifclassloaded{article}{%
		\loadcsthm%
		\sethepfonts%
		\providecommand{\commonheadingfont}{\normalfont\sffamily}%
		\setsectionformats%
		}{}%
	% Adjustments for the 'report' class
	\@ifclassloaded{report}{%
		\loadcsthm%
		\sethepfonts%
		\providecommand{\commonheadingfont}{\normalfont\sffamily}%
		\renewcommand{\thechapter}{\Roman{chapter}}%
		\setchapterformat%
		\setsectionformats%
		\adjusttocspacing{10pt}{10pt}{7.5pt}%
		\simplefancyheader%
		}{}%
	% Adjustments for the 'book' class
	\@ifclassloaded{book}{%
		\loadcsthm%
		\sethepfonts%
		\providecommand{\commonheadingfont}{\normalfont\sffamily}%
		\setchapterformat%
		\setsectionformats%
		\simplefancyheader%
		}{}%
	%%% Command Definitions %%%
	\NewDocumentCommand{\paragraphnodot}{m}{%
		\smallskip\noindent{\normalfont\bfseries#1}%
	}%
	\let\paragraph\relax%
	\NewDocumentCommand{\paragraph}{m}{%
		\smallskip\noindent{\normalfont\bfseries#1.}%
	}%
	\let\oldtableofcontents\tableofcontents%
	\renewcommand{\tableofcontents}{%
		\vfill\pagebreak%
		\oldtableofcontents%
		\vfill\pagebreak%
	}%
	\NewDocumentCommand{\bibliographyprint}{mm}{%
		\begingroup%
		\small\singlespacing%
		\bibliographystyle{#1}%
		\addcontentsline{toc}{section}{References}%
		\bibliography{#2}%
		\endgroup%
	}%
	\let\oldappendix\appendix%
	\renewcommand{\appendix}{%
		\section*{Appendix}%
		\addcontentsline{toc}{section}{Appendix}%
		\oldappendix%
	}%
	%%% Anonymization Adjustments %%%
	\ifAnonymize
    	\renewcommand{\@author}{}%
    	\renewcommand{\@date}{}%
        \renewcommand{\hep@preprint@box}{}%
    	% In anonymized mode, make the acknowledgment environment produce nothing.
    	\RenewDocumentEnvironment{acknowledgment}{ o }{}{ }
	\fi
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Captions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage[
	font={rm},                            % Roman font for captions
	labelfont={color=black!75,rm},        % Label font and colour
	labelsep=period,                      % Label, and content separator: period
	skip=1em                              % Spacing before captions
]{caption}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Package Versioning and Comment Macros (User-Level)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\NewDocumentCommand{\fullversion}{}{%
	\FullVersiontrue%
	\ShortVersionfalse%
}%
\NewDocumentCommand{\shortversion}{}{%
	\ShortVersiontrue%
	\FullVersionfalse%
}%
\NewDocumentCommand{\usecomments}{}{%
	\Commentstrue%
}%
\NewDocumentCommand{\newcomment}{mmm}{%
	\ifComments
	\expandafter\NewDocumentCommand\csname#3\endcsname{m}{%
		\noindent\textcolor{#2}{\sffamily##1 -- $\mathsf{#1}$}%
	}%
	\else
	   \expandafter\NewDocumentCommand\csname#3\endcsname{m}{}%
	\fi
}%

\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% End of package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\endinput